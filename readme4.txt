Т.к. не указано в каком направлении может ходить Робот, то положим сами, что только вверх или влево

Объясню. Если не так, то можем обходить все ячейки полностью, кроме одной (идем змейкой) и задача тривиальна

Поэтому полагаем, что только вверх или влево.
Теперь скопируем таблицу немного правее, что проводить с копией махинации

В каждой ячейке будет храниться максимальная (минимальная) сумма из всех идущих к этой ячейке путей
Начнем с правого нижнего угла, сначала пойдем до ячейки Е6, т.к. Робот в какой-то момент времени должен оказаться там

Пусть ответ будет лежать в ячейках А18 и А19 соответственно.

В правом нижнем углу копии таблицы пишем SUM($J$10:J10) и ведем вверх до упора (применяем на ряд).
Также применяем на строку влево до конца копии
Это максимальная сумма для ячеек, на которые мы применили формулу.
(Т.к. вправо и вниз идти нельзя)
Теперь для каждой клетки, на которую не дейтсвуют формулы (только на копии таблицы)
нужно делать выбор максимума из соседних ячеек (правой и нижней), так и напишем
=IF(U10 > V9, I9+U10, I9+V9)
/ это в ячейку U9 (сдвиг копии - 2 пустых ряда между ней и оригиналом)

Так как нужно заправиться на ячейке Е6, а из ячеек R1:V5 и M7:P10 туда попасть нашими движениями нельзя,
то очищаем эти клетки

Продлеваем до ячейки Q6 (заправка), итого 626 - максимальная сумма до заправки, аналогично делаем  до ячейки М1.

Q5 = SUM($E5:E$6) + $Q$6 - $E$6 и вверх
P6 = SUM($E$6:D6) + $Q$6 - $E$6 и влево
P5 = IF(P6 > Q5, D5+P6, D5+Q5) и вверх, и влево
в М1 - максимальная сумма


Минимум:
    Крайние ряды и строки заполняем так же
    I21 = IF(I22> J21, I9+J21, I9+I22) и влево и вверх до заправки
    Итого 361 - минимальная сумма до заправки

    Е17 = SUM($E5:E$6) + $E$18 - $E$6 и вверх
    D18 = SUM($E$6:D5) + $E$18 - $E$6 и влево
    D17 = IF(D18> E17, D5+E17, D5+D18) и влево, и вверх
в А13 - минимальная сумма


